[D:\游戏策划案\长期个人学习项目  初定终版.docx](file:///D:/%E6%B8%B8%E6%88%8F%E7%AD%96%E5%88%92%E6%A1%88/%E9%95%BF%E6%9C%9F%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0%E9%A1%B9%E7%9B%AE%20%20%E5%88%9D%E5%AE%9A%E7%BB%88%E7%89%88.docx)
# TODO 
- [1] 重构敌人ai 🔼
	- [x] 将敌人的意图重新写成枚举类型（就那么几种固定的），将敌人的攻击做成SO,把敌人的移动做成函数
     - [1] 对周围一部分格子进行攻击（遍历周围一圈的格子，如果玩家位于格子内，就进行攻击，如果不在，根据格子的属性对格子添加不同的effect（TODO））**CheckIfNoTarget函数**
    - [x] 对周围一圈格子进行范围攻击
    
	- [1] 进行移动后（这个移动的轨迹是固定的，可以被玩家看到）进行攻击——遍历移动范围内的所有格子并检验每个格子与玩家位置之间的距离，选择距玩家最近的为最终路径点（玩家在最远的移动范围+攻击范围外）,如果在移动后攻击范围内，则根据不同类型的敌人进行不同的操作——激进型、策略型、防御型
		- [ ] 显示敌人路径
		- [1] 敌人移动时避开lava或其他地块，但是玩家上一回合施加的地块效果无法被避开[[分析文档.canvas|分析文档]]
	- [1] 回血
    
	- [ ] 进行其他的操作
- [ ] 敌人采取的策略类型（策略类型目前只在移动后攻击上有区别）
	- [ ] 激进型——会一直跟着玩家
	- [ ] 防御型——根据玩家上一回合的位置进行攻击
	- [ ] 策略型——会尽量和玩家保持最大距离去攻击
- [1] 在玩家回合时，鼠标悬停在敌人身上时 ⏫
	- [ ] 显示敌人当前意图的作用范围
	- [ ] 显示在敌人回合结束后敌人的当前位置和地图的变化 
	- [ ] 在拖拽卡牌时，摄像头虚化背景并聚焦在当前场景上，突出角色（？可能不用这个设置）
```
public class EnemyIntent : MonoBehaviour, IPointerEnterHandler, IPointerExitHandler
{
    public GameEvent ShowIntentRange;//展示意图范围
    public GameEvent HideIntentRange；//隐藏

    public void OnPointerEnter(PointerEventData eventData)
    {
        ShowIntentRange.Raise(); // 显示范围
    }

    public void OnPointerExit(PointerEventData eventData)
    {
        HideIntentRange.Raise(); // 隐藏范围
    }
}

```
- [ ] 卡牌信息配置表（excel?so）
- [ ] 实现地形破坏功能
	- [x] 破坏——摧毁一个地砖（实际是disable cell的render并检测对应Tile上是否有Entity，若有，则执行fallen方法——使entity坠落并受到伤害，若没有，则只disable cell的render）
	- [1] 敌人途径到被摧毁的地砖时（overlaytile.isActive = false）------寻路能得寻路到目前被摧毁的地砖上，且敌人得能够走到这个瓦片上——判定路径上是否有瓦片的isActive=false,如果有，则若该瓦片的activecharacter不为空，则执行fallen方法。
	- [x] fallen方法——目前考虑是多建一个obj，用来表现瓦片掉落（？）或者是摧毁的效果——播放timeline动画
	- [ ] 人物掉落动画
	- [ ] 
- [x] 击败当前层的敌人后，相机自动上移 ⏫
	- [1] 击败当前层的敌人后，玩家传送到上一层（传送到哪里？值得深思！）
	- [ ]  传送动画（动画什么的都往后稍稍）
- [x] 摄像机一次限定移动一层的距离，且卡牌布局的位置不能改变（相对canvas的位置），限定，Top和Bottom都有边界 📅 2024-10-31
- [1] 层状态分为当前层，上层，下层，上层的再上一层，下层的再下一层
	- [ ] 默认只能看到当前，上，下三层，当玩家点击箭头按钮时能够观察到上层以及上上层的具体情况（下层同理）
	- [ ] 上上层和下下层的敌人默认不加入回合中
	- [x] 当玩家传送到上层或下层时再将上上层或是下下层的人加入combinedList
- [x] 在新一层生成新的敌人（默认上中下三层先生成敌人） ⏫
	- [x] 简化逻辑，enemycontainer和enemyspawner中更新敌人数量的逻辑重合了
	- [x] 检测当前层和上层的敌人数是否为0，当前层如果为0，生成上上层敌人，上层敌人数为0，生成上上层敌人
	- [x] 更新enemycontainer的数据结构，能够存储每一层的敌人数量
	- [ ] 在玩家当前层的敌人数为空后，上上上层的敌人需要在玩家传送后生成（不加入combineList）
	- [x] 开始时在第一层创建一个敌人，在第二层也创建1~2个敌人
	- [x] enenemyController中playercharacter列表中不为空，检测player的layer，如果在自己的当前层，则能够执行攻击等逻辑，不然只是一直在路径上徘徊
- [ ]  MapManager
	- [x] 在要生成敌人之前也要生成楼层Floor
	- [x] 在当前层敌人数量为空后，如果当前层的敌人在他自己的回合死亡，那么后续combinedlist中是别的敌人的回合触发tpWhenNoenemy，我想要只有玩家能够触发tpwhennoenemy
	- [1] 在地块上随机生成事件地块（商店，篝火等等）

	
- [x] 琢磨一下odin插件——会用就行
- [x] 优化UI系统，整合框架
- [x] 设计金币 🔼——场景切换后保持金币不变（数据持久，将金币也添加到SO——statscontainer之中，仅玩家需要）
	- [x] 给玩家添加gold字段，封装到Stat类型，用于计算玩家所得金币数
	- [x] 敌人死亡后掉落金币，金币能用来在商店购买遗物/卡牌
	- [ ] 在一场战斗结束后，掉落卡牌
- [1] 商店系统 ⏫ ➕ 2024-11-29 
	- [1] 利用CSVEditor读取商店的配置表文件
	- [ ] 在玩家购买商品后，解析shiopitemdataso的itemSOAddress，并从addressables group中实例化出对象加入到对应的存储容器中
	- [ ] 玩家拥有的遗物和药水用list存储，存档时在拆开存
	- [ ] 每次ShopPanel中会随机刷出不同的商品（遗物，卡牌，药水这几种类型的商品）
	- [ ] 拖动并购买商品，金币不够的话拖不太动商品（范围判断，如果金币不够商品就回弹到原来的位置）
	- [ ] 显示商品Panel后隐藏其他UI元素
	- [ ] 存储购买的商品（存档系统-json存储数据）——问题是存储什么数据？暂且先搁置，学起来又枯燥又难懂，小痛苦~~~
- [x] 先实现一下relic遗物机制吧 ⏫
- [ ] unity插件
	- [ ] 实现一下在unity中修改csv文件
	- [ ] 
- [ ] 存档系统
	- [ ] 对于存档系统来说，Scriptableobject转json并不支持复杂SO类（比如类内嵌套对象等），所以要考虑将对应的复杂SO类，转为对应的普通类进行[序列化](https://www.bilibili.com/opus/980703696992075785)。
	- [ ] 考虑慢慢地把项目从so存储改成json存储，以so存储的数据实在是有些过于臃肿了，好用但是不好维护
	- [ ] 保存数据类，重构entity，relic类，card类。
	- [ ] 将statscontainer修改成别的存储结构，而不是用so，这样游戏打包后玩家的状态并没有办法实时存储
- [1] 设计更多卡牌和遗物 🔽
- [x] 统一资源加载功能为addressables异步加载 并使用资源加载功能实现场景切换 ⏫ ➕ 2024-11-30 📅 2024-12-01
- [ ] 学习Unitask
- [ ] 美化一下UI，将玩家血条，遗物等信息整理一下
	- [ ] 玩家血条，玩家护甲，relic等UI元素存储在player的canvas下
	- [x] 制作descriptionPanel,用于响应鼠标悬停事件
# 美术资产

- [x] 主角四方向视图 
- [ ] 敌人素材
- [ ] 动画
	- [ ] 主角走路动画
- [ ] 卡牌背景
- [ ] 游戏背景
- [1] 游戏UI
	- [1] 开始界面
	- [ ] 死亡界面
	- [ ] 结束界面
	- [1] 游戏中界面


## Idea
- 将reachrange也纳入卡牌的信息显示中


# 需要修复的bug（已知）
- [1] 敌人初始会出生在岩浆格子上 🔽
- [x] 按下移动按钮后仍然能够点击结束按钮
- [x] 在tile被禁用后，寻路出现问题，没有办法及时更新路径
- [x] 在点击箭头移动摄像机后，卡牌没有跟随摄像机改变位置
- [ ] 攻击牌在第一次选择范围外的瓦片后，再选择一次范围内的敌人，能够攻击到范围内的敌人
- [ ] 卡牌位置修改，当前位置没有办法显示描述




# 角色设计
**角色名称**：亚当（Adam）——公司“修理工”

**角色背景**：  
亚当是公司的一名普通维修工，擅长处理各种机械故障、建筑问题以及意外事件。公司作为一个庞然大物，由数十层高的建筑构成，每一层负责不同领域的运营。作为公司内部的维修专家，亚当对于这座建筑的每一部分都了如指掌。某一天，亚当接到了一条看似普通的“修理公司”的命令，然而踏进公司之后，一切变得完全不同，现实世界与异次元交错，公司内部被奇异的地貌和怪物占据。亚当的任务是修复这个异变的公司，找出其背后的真相。

**角色性格**：

- **坚韧且冷静**：和《死亡搁浅》的山姆相似，亚当也是一个比较沉默寡言的人，面对各种危险时显得十分坚韧。他接受了公司“修理”的命令后便毫不犹豫地承担起责任。
- **勤奋与执着**：作为一名普通员工，他从没有想过会面对这样大的危机，但他本能地想要解决问题、完成任务，即便这意味着一次又一次的死亡轮回。
- **擅长利用环境**：亚当不是武器专家，也不是什么超级英雄，他的优势是利用手边的工具和环境来克服难关。他能巧妙地运用地形来应对异次元怪物。

**外观描述**：

- **维修工装**：亚当身着略显陈旧但耐用的蓝色维修服，维修服的口袋和腰间配备了各种工具，比如扳手、撬棍、测距仪等。外面可能有一件防护用的马甲，经过多次战斗已经有了不少刮痕和泥土痕迹。
- **背包**：和山姆类似，亚当背着一个大型背包，里面装满了各类修理工具和地形构造卡片（这是他创造地形的手段）。背包设计类似工程用具，模块化方便取用。
- **工具臂**：他有一个外挂的机械工具臂（类似《死亡搁浅》中的手臂支架），可以辅助他操作复杂工具，也可以用于攻击。这只工具臂能进行延展和固定，帮助亚当攀爬楼层、搬运物体、甚至对敌人进行近距离打击。
- **面容**：亚当的面容有些疲惫感，眼神中透露出经历过许多磨难的坚毅。他留有浅胡子，头发被随意扎起以免挡住视线，眉宇间透出坚定与一丝孤独感。

**装备与能力**：

- **工具卡牌**：亚当携带特殊的卡牌，这些卡牌以土木工程知识为基础，能改变地形或创造障碍。比如可以架起桥梁，填平陷阱，甚至利用火山能量攻击敌人。这些卡牌通过他的背包和工具臂释放，形成创造与破坏的双重效果。
- **行动条与行动力**：每次行动亚当都需要合理利用行动力，包括移动、攻击和地形改造。他能通过地形与敌人的互动来改变战局，例如把敌人引入火山口或拆掉敌人脚下的砖块使其坠落。
- **遗物与升级**：每击败一个精英敌人或探索特定区域，亚当可以获取一些遗物，这些遗物可能是古老的工程手册、神秘的图纸等，可以为他的卡牌或工具臂赋予额外的能力。

**心理与情感**：

- **孤独感**：就像山姆在《死亡搁浅》中对抗荒凉与孤独，亚当在这座被异次元扭曲的公司中也感受到巨大的孤独。他常常一个人在巨大的地形中前进，身边没有人可以依靠，只有通过击败敌人和不断修理来继续前进。
- **使命感**：虽然只是普通维修工，但他深知只有自己才能“修理”这座公司，这种使命感是支撑他不断前行、从死亡中不断归来的动力。


























































